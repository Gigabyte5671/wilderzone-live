<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Wilderzone Live</title>
    <meta name="author" content="Gigabyte5671">
    <meta name="theme-color" content="#FFFFFF">
    <link rel="stylesheet" href="../css/root.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="style.css">
    <style>@import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@1,700&display=swap');</style>
    <link rel="shortcut icon" href="../assets/images/ta.webp">
  </head>
  
  <body>
    <main>
      <div id="nav">
        <div>
        </div>
      </div>
      <div id="gallery">
      </div>
    </main>
  </body>
  
  <script src="../lib/jquery.min.js"></script>
  <script src="../lib/toSpokenDate.js"></script>
  <script>
    var gallery_db;
    $.ajax({
      dataType:"json",
      url:"gallery_db.json",
      cache:false,
      success:function(gallery_data){
        gallery_db = gallery_data;
        populateGallery();
      },
      error:function(xhr, status, err){
        console.log("Error " + xhr.status);
        populateGalleryError();
      }
    });
    
    function populateGallery(){
      Object.keys(gallery_db["images"]).forEach(function(k){
        if($("#" + k.toUpperCase())[0] == null){
          var item = '<div id="' + k.toUpperCase() + '" class="gallery_section">'
                   +   '<div class="gallery_section_title">'
                   +     '<img src="data:image/svg+xml;utf8,' + "<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='31' height='" + (k.length * 29) + "'><text x='0' y='30' display='block' fill='black' font-size='40px' font-weight='600' text-anchor='end' transform='rotate(-90)' opacity='0.9' font-family='Roobert,Helvetica Neue,Helvetica,Arial,sans-serif'>" + k.toUpperCase() + "</text></svg>" + '" draggable="false">'
                   +   '</div>'
                   +   '<div class="gallery_section_inner"></div>'
                   + '</div>';
          $("#gallery").append(item);
        }
        
        var i = 0;
        while(i < gallery_db["images"][k].length){
          var name = gallery_db["images"][k][i][0].split("/")[gallery_db["images"][k][i][0].split("/").length - 1];
          var extension = name.split(".")[1];
          var alternate = gallery_db["images"][k][i][1];
          name = name.split(".")[0];
          var size = gallery_db["images"][k][i][2];
          
          var item = '<div class="gallery_item">'
                   +   '<div class="gallery_item_inner" style="background-image:url(' + "'" + gallery_db["images"][k][i][0] + "'" + ');background-size:' + gallery_db["images"][k][i][3] + ';">'
                   +     '<div class="gallery_item_info">'
                   +       '<div>'
                   +         '<p style="font-weight:bold;" title="' + name + '">' + name + '</p>' //name
                   //+         (gallery_db["images"][k][i][1] == "" ? '' : '<p>Image&nbsp;by&nbsp;' + gallery_db["images"][k][i][1] + '</p>')
                   +       '</div>'
                   +       '<div>'
                   +         '<p style="width:9ch;min-width:9ch;max-width:9ch;overflow:hidden;">' + size + '</p>' //size
                   +         '<p>' + alternate + '</p>' //extension
                   +         '<img src="../assets/icons/download_black_24dp.svg" draggable="false" title="Download">' //dload link
                   +       '</div>'
                   +     '</div>'
                   +   '</div>'
                   + '</div>';
          
          $("#" + k.toUpperCase()).children(":nth-child(2)").append(item);
          i++;
        }
      });
    }
  </script>
</html>